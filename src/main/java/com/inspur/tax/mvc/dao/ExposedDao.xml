<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ExposedDao">
   <select id="queryTop5Qu" resultType="Map" parameterType="Map">
SELECT base.kw_id,base.num,qkq.q_utterance FROM
(SELECT  kw_id,count(kw_id) num FROM qa_logs
WHERE user_id = #{user_id , jdbcType=INTEGER}
GROUP BY kw_id
ORDER BY num DESC
LIMIT 0,5) base,intelligent_consulting.qa_kb_question qkq
WHERE base.kw_id = qkq.kw_id
   </select>
</mapper>